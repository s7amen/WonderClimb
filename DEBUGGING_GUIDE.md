# Ръководство за диагностика на проблеми

## Проблем: Страниците са празни (Катерачи, Сесии)

### Стъпка 1: Проверка на конзолата на браузъра

Отвори Developer Tools (F12) и провери Console таба. Трябва да видиш:

**За страницата Катерачи:**
- `Fetched users:` - показва какво е върнал endpoint-ът
- Ако има грешка: `Error fetching users:` и `Error response:`

**За страницата Сесии:**
- `Fetched sessions:` - показва какво е върнал endpoint-ът
- Ако има грешка: `Error fetching sessions:` и `Error response:`

### Стъпка 2: Проверка на Network таба

1. Отвори Network таба в Developer Tools
2. Рефрешни страницата
3. Провери заявките:
   - `/api/v1/admin/users` - за катерачи
   - `/api/v1/admin/calendar` - за сесии
4. Кликни на всяка заявка и провери:
   - **Status** - трябва да е 200 (OK)
   - **Response** - какво връща endpoint-ът
   - **Headers** - дали има Authorization token

### Стъпка 3: Възможни проблеми и решения

#### Проблем 1: 401 Unauthorized
**Причина:** Не си логнат или token-ът е изтекъл
**Решение:** 
- Излез и влез отново
- Провери дали имаш правилни роли (admin за admin страници)

#### Проблем 2: 403 Forbidden
**Причина:** Нямаш правилните роли
**Решение:**
- Провери дали потребителят има роля `admin`
- Провери backend логовете за детайли

#### Проблем 3: 404 Not Found
**Причина:** Endpoint-ът не съществува или не е правилно регистриран
**Решение:**
- Рестартирай backend сървъра
- Провери дали endpoint-ът съществува в `backend/src/routes/`

#### Проблем 4: 200 OK но празен масив
**Причина:** Няма данни в базата данни
**Решение:**
- Създай тестови данни:
  - За катерачи: Регистрирай нов потребител или добави роля `climber` на съществуващ
  - За сесии: Създай нова сесия от admin панела

#### Проблем 5: CORS грешка
**Причина:** Frontend и backend са на различни портове
**Решение:**
- Провери `frontend/.env` - трябва да има `VITE_API_URL=http://localhost:3000/api/v1`
- Провери backend CORS конфигурация

### Стъпка 4: Проверка на backend логовете

Провери backend конзолата за:
- Грешки при заявки
- Информация за authentication
- Информация за роли

### Стъпка 5: Ръчна проверка на endpoint-ите

Можеш да тестваш endpoint-ите директно с curl или Postman:

```bash
# За катерачи (трябва да имаш валиден token)
curl -H "Authorization: Bearer YOUR_TOKEN" http://localhost:3000/api/v1/admin/users

# За сесии (трябва да имаш валиден token)
curl -H "Authorization: Bearer YOUR_TOKEN" "http://localhost:3000/api/v1/admin/calendar?view=month&startDate=2024-01-01T00:00:00Z&endDate=2024-12-31T23:59:59Z"
```

## Често срещани проблеми

### Проблем: "Няма намерени потребители"
**Възможни причини:**
1. Няма потребители в базата данни
2. Endpoint-ът не работи правилно
3. Има проблем с authentication

**Решение:**
1. Провери конзолата за грешки
2. Провери Network таба за статус на заявката
3. Ако няма грешки, вероятно наистина няма данни - създай тестови данни

### Проблем: Страницата Сесии е празна
**Възможни причини:**
1. Няма сесии в базата данни
2. Endpoint-ът `/admin/calendar` не работи
3. Има проблем с дати/филтри

**Решение:**
1. Провери конзолата за грешки
2. Провери Network таба - дали заявката е успешна
3. Ако няма грешки, създай тестова сесия от admin панела

## Как да създадеш тестови данни

### За катерачи:
1. Регистрирай нов потребител от `/register`
2. Или използвай admin панела да добавиш роля `climber` на съществуващ потребител

### За сесии:
1. Отиди на страницата Сесии
2. Кликни "Създай сесия"
3. Попълни формата и запази

## Ако проблемът продължава

1. Провери всички логове (frontend конзола, backend конзола, Network таб)
2. Уверете се че backend сървърът работи
3. Уверете се че MongoDB е свързана
4. Провери дали имаш правилните роли

